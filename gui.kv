#:kivy 2.1.0

<Tabs>:
	size_hint: 1, 1
	pos_hint: {'center_x': .5, 'center_y': .5}
	do_default_tab: False

	TabbedPanelItem:
		text: 'Master Key'
		BoxLayout:
			spacing: 10
			orientation: 'vertical'
			canvas:
				Color:
					rgba: 1, 1, 1, .2
				Rectangle:
					pos: self.pos
					size: self.size
			GridLayout:
				cols:2
				rows:2
				size_hint: .35, .125
				pos_hint: {'center_x': .5, 'center_y': .5}
				Label:
					text: 'Box size (px)'
				Label:
					text: 'Px size (A)'
				TextInput:
					id: px1
					text: '256'
					multiline: False
				TextInput:
					id: A1
					text: '2.62'
					multiline: False
			TextInput:
				canvas:
					Color:
						rgba: 1, 1, 1, .6
					Rectangle:
						pos: self.pos
						size: self.size
				multiline: True
				readonly: True
				size_hint_y: .15
				size_hint_x: .9
				pos_hint: {'center_x': .5, 'center_y': .6}
				text: 'First, enter your current working directory or press Get CWD to fill it in. Then, if your file is located under your CWD, check the CWD box and enter the remaining file path. If the file is located elsewhere, uncheck the CWD box and type the full path. Last, hit the save button for each path.'
			BoxLayout:
				orientation: 'horizontal'
				spacing: 15
				BoxLayout:
					orientation: 'vertical'
					size_hint_x: 1.8
					spacing: 10
					BoxLayout:
						orientation: 'vertical'
						spacing: 10
						size_hint_y: .35
						canvas:
							Color:
								rgba: 1, 1, 1, .6
							Rectangle:
								pos: self.pos
								size: self.size
						BoxLayout:
							orientation: 'horizontal'
							spacing: 20
							size_hint: .6, .2
							pos_hint: {'center_x': .57, 'center_y': .5}
							Label:
								text: 'Current working directory:'
								color: (0,0,0,1)
								font_size: 30
								bold: True
								size_hint: 1.4, .8
								pos_hint: {'center_x': .5}
							AnchorLayout:
								anchor_x: 'left'
								Button:
									text: 'get cwd'
									on_press: root.cwd()
									pos_hint: {'center_x': .7, 'center_y': .5}
									size_hint: .55, .95
									background_color: 0, 1.2, 2, .5
						BoxLayout:
							size_hint: .7, .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							TextInput:
								text: ''
								size_hint: 1.2, .5
								font_size: 25
								pos_hint: {'center_x': .5, 'center_y': .5}
								multiline: False
								id: maincwd
					BoxLayout:
						orientation: 'vertical'
						size_hint_y: .6
						canvas:
							Color:
								rgba: 1, 1, 1, .6
							Rectangle:
								pos: self.pos
								size: self.size
						Label:
							text: 'Star file path'
							color: (0,0,0,1)
							font_size: 30
							bold: True
							size_hint: .6, .1
							pos_hint: {'center_x': .5, 'center_y': .5}
						BoxLayout:
							orientation: 'horizontal'
							size_hint: .9, .25
							pos_hint: {'center_x': .5, 'center_y': .5}
							BoxLayout:
								orientation: 'vertical'
								size_hint: .2, .5
								pos_hint: {'center_x': .5, 'center_y': .5}
								CheckBox:
									state: 'down'
									id: starcheck
									on_press: root.triggerstar()
								Label:
									text: 'cwd'
							Label:
								text: '+'
								size_hint_x: .1
								pos_hint: {'center_x': .5, 'center_y': .5}
							TextInput:
								text: '/Test_Data/test_2018filt.star'
								size_hint: 1.5, .55
								font_size: 25
								pos_hint: {'center_x': .5, 'center_y': .5}
								id: mainstar
								on_text: root.triggerstar()
						Label:
							size_hint_y: .06
							font_size: 25
							color: (.6,0,0,1)
							text: 'path not saved'
							pos_hint: {'center_x': .5, 'center_y': .5}
							id: starstatus
						Button:
							background_color: 0.2, 0.6, 0.2, .55
							text: 'Save star path'
							on_press: root.starsave()
							size_hint: .3, .12
							pos_hint: {'center_x': .5, 'center_y': .5}
					BoxLayout:
						orientation: 'vertical'
						size_hint_y: .6
						canvas:
							Color:
								rgba: 1, 1, 1, .6
							Rectangle:
								pos: self.pos
								size: self.size
						Label:
							text: 'mrc directory'
							color: (0,0,0,1)
							font_size: 30
							bold: True
							size_hint: .6, .1
							pos_hint: {'center_x': .5, 'center_y': .5}
						BoxLayout:
							orientation: 'horizontal'
							size_hint: .9, .25
							pos_hint: {'center_x': .5, 'center_y': .5}
							BoxLayout:
								orientation: 'vertical'
								size_hint: .2, .5
								pos_hint: {'center_x': .5, 'center_y': .5}
								CheckBox:
									state: 'down'
									id: mrccheck
									on_press: root.triggermrc()
								Label:
									text: 'cwd'
							Label:
								text: '+'
								size_hint_x: .1
								pos_hint: {'center_x': .5, 'center_y': .5}
							TextInput:
								text: '/Test_Data/'
								size_hint: 1.5, .55
								font_size: 25
								pos_hint: {'center_x': .5, 'center_y': .5}
								id: mainmrc
								on_text: root.triggermrc()
						Label:
							size_hint_y: .06
							font_size: 25
							color: (.6,0,0,1)
							text: 'path not saved'
							pos_hint: {'center_x': .5, 'center_y': .5}
							id: mrcstatus
						Button:
							background_color: 0.2, 0.6, 0.2, .55
							text: 'Save mrc path'
							on_press: root.mrcsave()
							size_hint: .3, .12
							pos_hint: {'center_x': .5, 'center_y': .5}
					BoxLayout:
						orientation: 'vertical'
						size_hint_y: .35
						canvas:
							Color:
								rgba: 1, 1, 1, .6
							Rectangle:
								pos: self.pos
								size: self.size
						Label: 
							text: 'ChimeraX path (default is SBgrid location)'
							size_hint_y: .2
							bold: True
							color: (0,0,0,1)
						TextInput:
							text: '/opt/sbgrid/i386-mac/chimerax/1.6.1/ChimeraX.app/Contents/bin'
							multiline: False
							font_size: 25
							size_hint: .8, .25
							pos_hint: {'center_x': .5, 'center_y': .5}
							id: chimera_path
						Label:
							size_hint_y: .1
				BoxLayout:
					orientation: 'vertical'
					spacing: 10
					BoxLayout:
						orientation: 'vertical'
						canvas:
							Color:
								rgba: 1, 1, 1, .6
							Rectangle:
								pos: self.pos
								size: self.size
						Label:
							text: 'Save project to directory:'
							size_hint_y: .3
							color: (0,0,0,1)
							font_size: 30
							bold: True
						TextInput:
							id: save
							hint_text: '/.../...'
							multiline: False
							size_hint: .7, .35
							font_size: 22.5
							pos_hint: {'center_x': .5, 'center_y': .5}
						Label: 
							text: 'Project name:'
							size_hint_y: .3
							color: (0,0,0,1)
							font_size: 30
							bold: True
						TextInput:
							id: savename
							hint_text: 'project'
							multiline: False
							size_hint: .7, .35
							font_size: 25
							pos_hint: {'center_x': .5, 'center_y': .5}
						Label:
							size_hint_y: .1
						Button:
							text: 'Save'
							on_release: root.savedata()
							size_hint: .4, .4
							pos_hint: {'center_x': .5, 'center_y': .5}
							background_color: 0, 1.2, 2, .5
						Label:
							size_hint_y: .1
					BoxLayout:
						orientation: 'vertical'
						canvas:
							Color:
								rgba: 1, 1, 1, .6
							Rectangle:
								pos: self.pos
								size: self.size
						Label:
							text: 'Load project path:'
							size_hint_y: .3
							color: (0,0,0,1)
							font_size: 30
							bold: True
						TextInput:
							id: pullpath
							multiline: False
							hint_text: '/.../.../project.txt'
							size_hint: .8, .35
							pos_hint: {'center_x': .5, 'center_y': .5}
						Label:
							size_hint_y: .1
						Button:
							text: 'Load'
							on_release: root.pulldata()
							size_hint: .4, .4
							pos_hint: {'center_x': .5, 'center_y': .5}
							background_color: 0, 1.2, 2, .5
						Label:
							size_hint_y: .1
	TabbedPanelItem:
		text: 'Filtering'
		BoxLayout:
			canvas:
				Color:
					rgba: 1, 1, 1, .6
				Rectangle:
					pos: self.pos
					size: self.size
			orientation: 'vertical'
			BoxLayout:
				orientation: 'horizontal'
				size_hint_y: .1
				pos_hint: {'center_x': .5, 'center_y': .5}
				Label: 
					text: 'Filter mrc'
					color: (0,0,0,1)
					font_size: 35
					size_hint_y: .6
					bold: True
				Label:
					text: ' '
					size_hint_x: .35
				Label:
					text: 'Note: mrc directory and Px size (A) must be entered on Master Key tab'
					color: (.6,0,.6,1)
					font_size: 25
					size_hint_y: .6
				Label:
					text: ' '
			BoxLayout:
				canvas:
					Color:
						rgba: .5, .5, .5, 0.4
					Rectangle:
						pos: self.pos
						size: self.size
				orientation: 'vertical'
				size_hint: .95, .9
				pos_hint: {'center_x': .5, 'center_y': .5}
				id: gray_box
				Label:
					size_hint_y: .2
				BoxLayout:
					orientation: 'horizontal'
					size_hint: .5, .1
					pos_hint: {'center_x': .5}
					CheckBox:
						group: 'g2'
						id: wienerbutton
						on_active: root.show_screen()
						state: 'down'
					Label:
						text: 'Wiener'
						bold: True
					Label:
						size_hint_x: .2
					CheckBox: 
						group: 'g2'
						id: gaussianbutton
						on_active: root.show_screen()
					Label:
						text: 'Gaussian'
						bold: True
				Label:
					size_hint_y: .2
				BoxLayout:
					orientation: 'horizontal'
					size_hint_y: .45
					id: first_row_wiener
					BoxLayout:
						orientation: 'vertical'
						id: boxone
						Label:
							text: 'Defocus (um)'
						TextInput:
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							text: '3'
							multiline: False
							id: defoc
						Label:
							text: ' '
							size_hint_y: .3
						Label:
							text: ' '
							color: (.6,0,0,1)
							font_size: 22
							size_hint_y: .1
					BoxLayout:
						orientation: 'vertical'
						id: boxtwo
						Label:
							text: 'SNR falloff'
						TextInput:
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							text: '1.2'
							multiline: False
							id: snrval
						Label:
							text: ' '
							size_hint_y: .3
						Label:
							text: 'recommended range: 0.9 to 1.2'
							color: (.6,0,.6,1)
							font_size: 22
							size_hint_y: .1
					BoxLayout:
						orientation: 'vertical'
						id: boxthree
						Label:
							text: 'Highpassnyquist'
						TextInput:
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							text: '0.01'
							multiline: False
							id: highpass
						Label:
							text: ' '
							size_hint_y: .3
						Label:
							text: ' '
							color: (.6,0,0,1)
							font_size: 22
							size_hint_y: .1
					BoxLayout:
						orientation: 'vertical'
						id: boxfour
						Label:
							text: 'Input Tomogram\nPhase-Flipped?'
						CheckBox:
							state: 'normal'
							id: phaseflip
						Label:
							text: ' '
							size_hint_y: .3
						Label:
							text: ' '
							color: (.6,0,0,1)
							font_size: 22
							size_hint_y: .1
				BoxLayout:
					orientation: 'vertical'
					id: gaussian_row
					size_hint_y: .25
				BoxLayout:
					orientation: 'horizontal'
					size_hint_y: .45
					id: second_row_wiener
					BoxLayout:
						orientation: 'vertical'
						id: boxfive
						Label:
							text: 'Voltage (eV)'
						TextInput:
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							text: '300e3'
							multiline: False
							id: voltage
						Label:
							text: ' '
							size_hint_y: .3
						Label:
							text: 'for Titan Krios'
							color: (.6,0,.6,1)
							font_size: 22
							size_hint_y: .1
					BoxLayout:
						orientation: 'vertical'
						id: boxsix
						Label:
							text: 'CS'
						TextInput:
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							text: '2.7e-3'
							multiline: False
							id: cs
						Label:
							text: ' '
							size_hint_y: .3
						Label:
							text: 'for Titan Krios'
							color: (.6,0,.6,1)
							font_size: 22
							size_hint_y: .1
					BoxLayout:
						orientation: 'vertical'
						id: boxseven
						Label:
							text: 'Envelope'
						TextInput:
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							text: '0.07'
							multiline: False
							id: envelope
						Label:
							text: ' '
							size_hint_y: .3
						Label:
							text: 'for Titan Krios'
							color: (.6,0,.6,1)
							font_size: 22
							size_hint_y: .1
					BoxLayout:
						orientation: 'vertical'
						id: boxeight
						Label:
							text: 'B-Factor'
						TextInput:
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							text: '0'
							multiline: False
							id: bfactor
						Label:
							text: ' '
							size_hint_y: .3
						Label:
							text: ' '
							color: (.6,0,0,1)
							font_size: 22
							size_hint_y: .1
				Label:
					size_hint_y: .4
				Button:
					background_color: 0.2, 0.6, 0.2, .55
					text: 'Filter Volumes'
					on_release: root.filter_vol()
					size_hint: .4, .3
					pos_hint: {'center_x': .5, 'center_y': .5}
				Label:
					size_hint_y: .4


			Label:
				size_hint_y: .1

	TabbedPanelItem:
		text: 'Coord. Picker'
		BoxLayout:
			spacing: 10
			canvas:
				Color:
					rgba: 1, 1, 1, .2
				Rectangle:
					pos: self.pos
					size: self.size
			orientation: 'vertical'
			BoxLayout:
				canvas:
					Color:
						rgba: 1, 1, 1, .6
					Rectangle:
						pos: self.pos
						size: self.size
				orientation: 'vertical'
				spacing: 15
				Label:
					text: ' '
					size_hint_y: .05
				Label: 
					text: 'Coord re-picker'
					color: (0,0,0,1)
					font_size: 35
					pos_hint: {'center_x': .15}
					bold: True
					size_hint_y: .08
				
				BoxLayout:
					canvas:
						Color:
							rgba: .5, .5, .5, 0.4
						Rectangle:
							pos: self.pos
							size: self.size
					orientation: 'horizontal'
					size_hint: .85, 1.2
					pos_hint: {'center_x': .5}
					BoxLayout:
						orientation: 'vertical'
						Label:
							size_hint_y: .25
						Label:
							text: 'ChimeraX output directory'
							size_hint_y: .5
						BoxLayout:
							orientation: 'horizontal'
							size_hint: .9, .4
							pos_hint: {'center_x': .5, 'center_y': .5}
							BoxLayout:
								orientation: 'vertical'
								size_hint: .3, .65
								pos_hint: {'center_x': .5, 'center_y': .5}
								CheckBox:
									state: 'down'
									id: codcheck
								Label:
									text: 'cwd'
							Label:
								text: '+'
								size_hint_x: .1
								pos_hint: {'center_x': .5, 'center_y': .5}
							TextInput:
								text: '/cmm_files'
								size_hint: 1.5, .8
								pos_hint: {'center_x': .5, 'center_y': .5}
								multiline: False
								id: chimera_out
						BoxLayout:
							orientation: 'horizontal'
							size_hint_x: .9
							pos_hint: {'center_x': .5}
							BoxLayout:
								orientation: 'vertical'
								size_hint: .4, .8
								pos_hint: {'center_y': .5}
								Label:
									text: 'Surface level'
									size_hint: 1, .8
									pos_hint: {'center_x': .5, 'center_y': .5}
								TextInput:
									text: '0.5'
									multiline: False
									size_hint: .7, .8
									pos_hint: {'center_x': .5, 'center_y': .5}
									id: surface_level
							Label:
								text: 'Index'
								size_hint_x: .2
								pos_hint: {'center_x': .3, 'center_y': .5}
							TextInput:
								text: '1'
								multiline: False
								size_hint: .2, .35
								pos_hint: {'center_x': .5, 'center_y': .5}
								id: index
							Label:
								text: 'of'
								size_hint_x: .2
								pos_hint: {'center_x': .5, 'center_y': .5}
							TextInput:
								text: '0'
								multiline: False
								size_hint: .2, .35
								pos_hint: {'center_x': .5, 'center_y': .5}
								id: index2
						BoxLayout:
							orientation: 'horizontal'
							size_hint: .8, .8
							pos_hint: {'center_x': .5}
							spacing: 50
							Button:
								background_color: 0.2, 0.6, 0.2, .55
								text: '<='
								on_release: root.left_pick()
								size_hint: .15, .7
								pos_hint: {'center_x': .5, 'center_y': .5}
							Button:
								background_color: 0.2, 0.6, 0.2, .55
								text: 'Pick coordinates'
								on_release: root.pick_coord()
								size_hint: .7, .7
								pos_hint: {'center_x': .5, 'center_y': .5}
							Button:
								background_color: 0.2, 0.6, 0.2, .55
								text: '=>'
								on_release: root.right_pick()
								size_hint: .15, .7
								pos_hint: {'center_x': .5, 'center_y': .5}
						Label:
							text: 'Click above to begin.'
							size_hint_y: .25
							color: (250, 250, 31, 1)
							id: pickcoordtext
						Label:
							size_hint_y: .25
					TextInput:
						multiline: True
						readonly: True
						text: 'Click Pick coordinates to Right click to select coordinates. Navigate to Markers menu and select Move if you need to adjust the location of the coordinate.\n\nWhen finished, save coord file using command save coord.cmm. Then exit Chimera. Press the right arrow to progress; the next subtomogram will automatically open.\n\nWhen you are done with all of your picks, press the Create .coords button to create new coordinate files.'
						size_hint: .9, .85
						pos_hint: {'center_x': .5, 'center_y': .5}
					Label:
						text: ' '
						size_hint_x: .03
				BoxLayout:
					orientation: 'horizontal'
					size_hint: .9, .1
					pos_hint: {'center_x': .5, 'center_y': .5}
					TextInput:
						size_hint_x: .9
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
						id: filenameget
					Button:
						background_color: 0, 1.2, 2, .5
						text: 'get file name'
						on_release: root.filename()
						size_hint_x: .15
				BoxLayout:
					orientation: 'horizontal'
					size_hint: .85, .3
					pos_hint: {'center_x': .5, 'center_y': .5}
					BoxLayout:
						orientation: 'vertical'
						size_hint: .13, 1
						pos_hint: {'center_x': .5, 'center_y': .2}
						Button:
							background_color: 0.2, 0.6, 0.2, .55
							text: 'Add note'
							on_release: root.note()
							size_hint_y: 1.6
						Label:
							text: ' '
							color: (250, 250, 31, 1)
							id: notesave
					Label:
						text: ' '
						size_hint_x: .05
					TextInput:
						multiline: True
						size_hint: .65, .8
						id: notecoord
				Label:
					text: ' '
					size_hint_y: .04
				BoxLayout:
					orientation: 'horizontal'
					size_hint_y: .18
					BoxLayout: 
						size_hint: .75, 1.3
						orientation: 'vertical'
						Label:
							text: 'Save coordinate directory'
							size_hint_y: .4
						BoxLayout:
							orientation: 'horizontal'
							size_hint_x: .85
							pos_hint: {'center_x': .5, 'center_y': .5}
							BoxLayout:
								orientation: 'vertical'
								size_hint: .3, .5
								pos_hint: {'center_x': .5, 'center_y': .5}
								CheckBox:
									state: 'down'
									id: direcheck
								Label:
									text: 'cwd'
							Label:
								text: '+'
								size_hint_x: .1
								pos_hint: {'center_x': .5, 'center_y': .5}
							TextInput:
								text: '/cmm_files'
								size_hint: 1.5, .55
								pos_hint: {'center_x': .5, 'center_y': .5}
								multiline: False
								id: chimera_coord
					Button:
						background_color: 0, 0, 1, .7
						text: 'Create .coordsnew'
						on_release: root.create_coords()
						size_hint_x: .2
					Label:
						text: ' '
						size_hint_x: .02
				Label:
					text: ' '
					size_hint_y: .07
	TabbedPanelItem:
		text: 'Parser'
		BoxLayout:
			spacing: 10
			orientation: 'vertical'
			canvas:
				Color:
					rgba: 1, 1, 1, .2
				Rectangle:
					pos: self.pos
					size: self.size
			BoxLayout:
				canvas:
					Color:
						rgba: 1, 1, 1, .6
					Rectangle:
						pos: self.pos
						size: self.size
				orientation: 'vertical'
				spacing: 15
				Label:
					size_hint_y: .05
				TextInput:
					canvas:
						Color:
							rgba: 1, 1, 1, .6
						Rectangle:
							pos: self.pos
							size: self.size
					multiline: True
					readonly: True
					size_hint_y: .2
					size_hint_x: .9
					pos_hint: {'center_x': .5, 'center_y': .6}
					text: 'Select which output data you would like returned using checkbox and column input.\nThe star file entered on this tab is unique from the star file on the Master Key tab.'
				Label:
					text: 'Re-extraction'
					color: (0,0,0,1)
					font_size: 35
					pos_hint: {'center_x': .15}
					bold: True
					size_hint_y: .2
				BoxLayout:
					canvas:
						Color:
							rgba: .5, .5, .5, 0.4
						Rectangle:
							pos: self.pos
							size: self.size
					orientation: 'vertical'
					size_hint_x: .8
					pos_hint: {'center_x': .5}
					BoxLayout:
						orientation: 'horizontal'
						pos_hint: {'center_x': .5}
						size_hint: 1, .3
						canvas:
							Color:
								rgba: .3, .3, .3, 0.4
							Rectangle:
								pos: self.pos
								size: self.size
						BoxLayout:
							orientation: 'vertical'
							size_hint: .3, .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							CheckBox:
								state: 'down'
								id: cooc
							Label:
								text: 'Coordinates'
						BoxLayout:
							orientation: 'vertical'
							size_hint_y: .7
							pos_hint: {'center_x': .5, 'center_y': .5}
							Label:
								text: 'Other Columns (comma delimited):'
								size_hint_y: .4
							TextInput:
								multiline: False
								hint_text: '1,2,3'
								id: othercols
								size_hint: .7, .5
								pos_hint: {'center_x': .5, 'center_y': .5}
						Label:
							size_hint_x: .075
					Label:
						text: 'Star file path:'
						size_hint_y: .15
					BoxLayout:
						orientation: 'horizontal'
						size_hint: .7, .2
						pos_hint: {'center_x': .5, 'center_y': .5}
						BoxLayout:
							orientation: 'vertical'
							size_hint: .3, .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							CheckBox:
								state: 'down'
								id: parscheck
							Label:
								text: 'cwd'
						Label:
							text: '+'
							size_hint_x: .1
							pos_hint: {'center_x': .5, 'center_y': .5}
						TextInput:
							text: '/Test_Data/test_2018filt.star'
							size_hint: 1.5, .55
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
							id: restar
					Label:
						text: 'Output path:'
						size_hint_y: .15
					BoxLayout:
						orientation: 'horizontal'
						size_hint: .7, .2
						pos_hint: {'center_x': .5, 'center_y': .5}
						BoxLayout:
							orientation: 'vertical'
							size_hint: .3, .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							CheckBox:
								state: 'down'
								id: parsoutcheck
							Label:
								text: 'cwd'
						Label:
							text: '+'
							size_hint_x: .1
							pos_hint: {'center_x': .5, 'center_y': .5}
						TextInput:
							text: '/newcoord'
							size_hint: 1.5, .55
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
							id: reout
					Button:
						background_color: 0.2, 0.6, 0.2, .55
						text: 'Parse star file'
						on_release: root.parse()
						size_hint: .25, .12
						pos_hint: {'center_x': .5}
					Label:
						size_hint_y: .1
				Label:
					size_hint_y: .2

	TabbedPanelItem:
		text: 'Calc. Angles'
		BoxLayout:
			spacing: 10
			canvas:
				Color:
					rgba: 1, 1, 1, .2
				Rectangle:
					pos: self.pos
					size: self.size
			
			orientation: 'vertical'
			TextInput:
				canvas:
					Color:
						rgba: 1, 1, 1, .6
					Rectangle:
						pos: self.pos
						size: self.size
				multiline: True
				readonly: True
				size_hint_y: .12
				size_hint_x: .9
				pos_hint: {'center_x': .5, 'center_y': .6}
				text: 'Enter the path of the folder containing .cmm files. Then enter the folder path which contains .coords files for that tomogram. Specify which file you want using the suffix and ensure proper binning.'
			GridLayout:
				canvas:
					Color:
						rgba: 1, 1, 1, .6
					Rectangle:
						pos: self.pos
						size: self.size
				rows:1
				cols:2
				size_hint_y: .2
				spacing: 15
				BoxLayout:
					orientation: 'vertical'
					size_hint_x: .75
					Label: 
						text: 'Cmm file path'
					BoxLayout:
						orientation: 'horizontal'
						size_hint_x: .7
						pos_hint: {'center_x': .5, 'center_y': .5}
						BoxLayout:
							orientation: 'vertical'
							size_hint: .3, .5
							pos_hint: {'center_x': .5, 'center_y': .5}
							CheckBox:
								state: 'down'
								id: dircmmcheck
							Label:
								text: 'cwd'
						Label:
							text: '+'
							size_hint_x: .1
							pos_hint: {'center_x': .5, 'center_y': .5}
						TextInput:
							text: '/'
							size_hint: 1.5, .8
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
							id: cmmf
				Button:
					background_color: 0.2, 0.6, 0.2, .55
					size_hint_x: .25
					text: 'Get path from Coord Picker'
					on_release: root.path_1()
			BoxLayout:
				canvas:
					Color:
						rgba: 1, 1, 1, .6
					Rectangle:
						pos: self.pos
						size: self.size
				orientation: 'vertical'
				spacing: 15
				Label:
					text: 'Calculate Rotations'
					color: (0,0,0,1)
					font_size: 35
					pos_hint: {'center_x': .2}
					size_hint_y: .7
					bold: True
				Label:
					text: 'Coordinate Files Folder Path'
					size_hint_y: .7
				TextInput:
					text: '/'
					size_hint: .7, .7
					pos_hint: {'center_x': .5}
					multiline: False
					id: coordf
				Label:
					text: 'Note: must contain all of the .coord files'
					color: (250, 250, 31, 1)
					size_hint_y: .5
				BoxLayout:
					size_hint: .8, 1.5
					pos_hint: {'center_x': .445, 'center_y': .5}
					orientation: 'horizontal'
					canvas:
						Color:
							rgba: .3, .3, .3, 0.4
						Rectangle:
							pos: self.pos
							size: self.size
					BoxLayout:
						orientation: 'vertical'
						size_hint: .3, .5
						pos_hint: {'center_x': .7, 'center_y': .5}
						CheckBox:
							id: otherdir
						Label:
							text: 'Activate row'
					BoxLayout:
						orientation: 'vertical'
						Label:
							text: 'First .coord file suffix'
						TextInput:
							text: 'I'
							size_hint_x: .3
							pos_hint: {'center_x': .5}
							multiline: False
							id: suffixt
						Label:
							text: ''
							color: (250, 250, 31, 1)
							size_hint_y: .5
					BoxLayout:
						orientation: 'vertical'
						Label:
							text: 'First .coord file Bin'
						TextInput:
							text: '1'
							size_hint_x: .3
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
							id: binnt
						Label:
							text: ' '
							size_hint_y: .5
				BoxLayout:
					size_hint: .7, 1.5
					pos_hint: {'center_x': .5, 'center_y': .5}
					orientation: 'horizontal'
					BoxLayout:
						orientation: 'vertical'
						Label:
							text: 'Second .coord file suffix'
						TextInput:
							text: 'C'
							size_hint_x: .3
							pos_hint: {'center_x': .5}
							multiline: False
							id: suffixf
						Label:
							text: ''
							color: (250, 250, 31, 1)
							size_hint_y: .5
					BoxLayout:
						orientation: 'vertical'
						Label:
							text: 'Second .coord file Bin'
						TextInput:
							text: '4'
							size_hint_x: .3
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
							id: binnf
						Label:
							text: ' '
							size_hint_y: .5
				Button:
					background_color: 0.2, 0.6, 0.2, .55
					text: 'Calculate Angles'
					on_release: root.calculate_ang()
					size_hint: .28, .8
					pos_hint: {'center_x': .5}
				Label:
					text: 'Output Path'
					size_hint_y: .5
				BoxLayout:
					orientation: 'horizontal'
					size_hint: .8, .9
					pos_hint: {'center_x': .5, 'center_y': .5}
					BoxLayout:
						orientation: 'vertical'
						size_hint: .3, .5
						pos_hint: {'center_x': .5, 'center_y': .5}
						CheckBox:
							state: 'down'
							id: calcoutcheck
						Label:
							text: 'cwd'
					Label:
						text: '+'
						size_hint_x: .1
						pos_hint: {'center_x': .5, 'center_y': .5}
					TextInput:
						text: '/cmm_files/Out'
						size_hint: 1.5, .55
						multiline: False
						pos_hint: {'center_x': .5, 'center_y': .5}
						id: outputp
				Label:
					text: ' '
					size_hint_y: .3

	TabbedPanelItem:
		text: '3D Signal Sub.'
		BoxLayout:
			spacing: 10
			canvas:
				Color:
					rgba: 1, 1, 1, .2
				Rectangle:
					pos: self.pos
					size: self.size
			orientation: 'vertical'
			GridLayout:
				rows:2
				canvas:
					Color:
						rgba: 1, 1, 1, .6
					Rectangle:
						pos: self.pos
						size: self.size
				spacing: 0, 18
				BoxLayout:
					orientation: 'horizontal'
					BoxLayout:
						canvas:
							Color:
								rgba: .5, .5, .5, 0.4
							Rectangle:
								pos: self.pos
								size: self.size
						orientation: 'vertical'
						spacing: 15
						size_hint_x: .9
						pos_hint: {'center_x': .5}
						Label:
							text: 'Create Mask'
							color: (0,0,0,1)
							font_size: 35
							pos_hint: {'center_x': .15}
							bold: True
						Spinner:
							background_color: 0, 0, 1, .7
							text: 'Cylinder'
							values: 'Sphere', 'Cylinder'
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
						GridLayout:
							cols:2
							rows:2
							size_hint: .9, 1.2
							spacing: 15
							pos_hint: {'center_x': .5, 'center_y': .5}
							Label:
								text: 'Mask radius (px)'
								size_hint: .9, .7
								pos_hint: {'center_x': .5, 'center_y': .5}
							Label:
								text: 'Cyl height (px)'
								size_hint: .9, .7
								pos_hint: {'center_x': .5, 'center_y': .5}
							TextInput:
								text: '35'
								size_hint_x: .5
								pos_hint: {'center_x': .5, 'center_y': .5}
								multiline: False
							TextInput:
								text: '65'
								size_hint_x: .5
								pos_hint: {'center_x': .5, 'center_y': .5}
								multiline: False
						Label:
							text: 'Vertical Translation (px)'
							size_hint: .7, .5
							pos_hint: {'center_x': .5, 'center_y': .5}
						TextInput:
							text: '-8'
							size_hint: .2, .7
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
						Label:
							text: 'Save mask as'
							size_hint: .8, .5
							pos_hint: {'center_x': .5, 'center_y': .5}
						TextInput:
							text: 'mask.mrc'
							size_hint: .6, .7
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
						Button:
							background_color: 0.2, 0.6, 0.2, .55
							text: 'Make Mask'
							on_release: root.mask()
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
						Label:
							text: ' '
							size_hint_y: .1
					AnchorLayout:
						anchor_y: 'top'
						BoxLayout:
							canvas:
								Color:
									rgba: .5, .5, .5, 0.4
								Rectangle:
									pos: self.pos
									size: self.size
							orientation: 'vertical'
							spacing: 15
							size_hint: .9, .5
							pos_hint: {'center_x': .5}
							Label:
								text: 'Display mrc in tom xyz'
								color: (0,0,0,1)
								font_size: 35
								pos_hint: {'center_x': .26}
								bold: True
							Label:
								text: 'mrc path'
							TextInput:
								text: 'mask.mrc'
								size_hint_x: .6
								pos_hint: {'center_x': .5, 'center_y': .5}
								multiline: False
							Button:
								background_color: 0.2, 0.6, 0.2, .55
								text: 'Display Volume'
								on_release: root.volume()
								size_hint_x: .5
								pos_hint: {'center_x': .5, 'center_y': .5}
							Label:
								text: ' '
								size_hint_y: .1
				BoxLayout:
					orientation: 'horizontal'
					BoxLayout:
						orientation: 'vertical'
						spacing: 10
						size_hint_x: 1.4
						canvas:
							Color:
								rgba: .5, .5, .5, 0.4
							Rectangle:
								pos: self.pos
								size: self.size
						Label:
							text: '3D Signal Subtraction'
							color: (0,0,0,1)
							font_size: 35
							pos_hint: {'center_x': .2}
							bold: True
						Label:
							text: 'Mask path'
						TextInput:
							text: 'mask.mrc'
							size_hint_x: .9
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
						Label:
							text: 'Star file path'
						TextInput:
							text: 'test.star'
							size_hint_x: .9
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
						Label:
							text: 'Subtomogram directory'
						TextInput:
							text: 'Extract/extract_test/201810XX_MPI/'
							size_hint_x: .9
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
						Label:
							text: 'Output directory'
						TextInput:
							text: 'Extract/extract_test/201810XX_MPI_reextract/'
							size_hint_x: .9
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
						Button:
							background_color: 0.2, 0.6, 0.2, .55
							text: 'Re-extract'
							on_release: root.reextract()
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
						Label:
							text: ' '
							size_hint_y: .1
					BoxLayout:
						canvas:
							Color:
								rgba: .5, .5, .5, 0.4
							Rectangle:
								pos: self.pos
								size: self.size
						orientation: 'vertical'
						BoxLayout:
							size_hint_x: .5
							pos_hint: {'center_x': .5}
							orientation: 'horizontal'
							CheckBox:
								state: 'down'
							Label:
								text: 'Filter background'
						BoxLayout:
							pos_hint: {'center_x': .5}
							size_hint: .7, .8
							orientation: 'horizontal'
							BoxLayout:
								size_hint_x: .5
								pos_hint: {'center_x': .5}
								orientation: 'horizontal'
								CheckBox:
									state: 'down'
									group: 'g3'
								Label: 
									text: 'Shift by SD'
							BoxLayout:
								size_hint_x: .5
								pos_hint: {'center_x': .5}
								orientation: 'horizontal'
								CheckBox:
									group: 'g3'
								Label: 
									text: 'Rand Noise'
						BoxLayout:
							size_hint_x: .5
							pos_hint: {'center_x': .5}
							orientation: 'horizontal'
							CheckBox:
								state: 'down'
							Label:
								text: 'Black dust removal'
						BoxLayout:
							size_hint_x: .5
							pos_hint: {'center_x': .5}
							orientation: 'horizontal'
							CheckBox:
								state: 'down'
							Label:
								text: 'White dust removal'
						GridLayout:
							rows: 2
							cols: 2
							size_hint: .7, 1.2
							pos_hint: {'center_x': .5}
							spacing: 0, 5
							Label:
								text: 'S.D thresh to filter'
							TextInput:
								text: '2.0'
								size_hint_x: .4
								pos_hint: {'center_x': .5}
								multiline: False
							Label:
								text: 'S.D shift'
							TextInput:
								text: '1.0'
								size_hint_x: .4
								pos_hint: {'center_x': .5}
								multiline: False
						BoxLayout:
							size_hint_x: .55
							pos_hint: {'center_x': .5}
							orientation: 'horizontal'
							CheckBox:
								state: 'down'
							Label:
								text: 'Permute Background'
						BoxLayout:
							orientation: 'horizontal'
							size_hint: .5, .8
							pos_hint: {'center_x': .5}
							Label:
								text: 'Mask blur rate'
								pos_hint: {'center_x': .2}
							TextInput:
								text: '1.1'
								size_hint: .4, .8
								pos_hint: {'center_x': .8, 'center_y': .5}
								multiline: False
						BoxLayout:
							orientation: 'horizontal'
							size_hint_x: .55
							pos_hint: {'center_x': .5}
							CheckBox:
							Label:
								text: 'Normalize after filtering'
						Label:
							text: ' '
							size_hint_y: .1
	TabbedPanelItem:
		text: 'Cross-correl.'
		BoxLayout:
			spacing: 10
			canvas:
				Color:
					rgba: 1, 1, 1, .2
				Rectangle:
					pos: self.pos
					size: self.size
			orientation: 'vertical'
			GridLayout:
				cols: 2
				rows: 2
				canvas:
					Color:
						rgba: 1, 1, 1, .6
					Rectangle:
						pos: self.pos
						size: self.size
				spacing: 15
				AnchorLayout:
					anchor_y: 'top'
					BoxLayout:
						size_hint_y: .8
						orientation: 'vertical'
						canvas:
							Color:
								rgba: .5, .5, .5, 0.4
							Rectangle:
								pos: self.pos
								size: self.size
						spacing: 15
						Label:
							text: 'Calculate CCC - Two Volumes'
							color: (0,0,0,1)
							font_size: 35
							pos_hint: {'center_x': .32}
							bold: True
						Label: 
							text: 'Volume 1'
						TextInput:
							text: '.mrc'
							size_hint_x: .9
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
						Label:
							text: 'Volume 2'
						TextInput:
							text: '.mrc'
							size_hint_x: .9
							pos_hint: {'center_x': .5, 'center_y': .5}
							multiline: False
						Button:
							background_color: 0.2, 0.6, 0.2, .55
							text: 'Calculate CCC'
							on_release: root.calculate_ccc()
							size_hint_x: .5
							pos_hint: {'center_x': .5, 'center_y': .5}
						Label:
							text: ' '
							size_hint_y: .04

				BoxLayout:
					orientation: 'vertical'
					canvas:
						Color:
							rgba: .5, .5, .5, 0.4
						Rectangle:
							pos: self.pos
							size: self.size
					Label:
						text: 'Volume & Star File'
						color: (0,0,0,1)
						font_size: 35
						pos_hint: {'center_x': .2}
						bold: True
					Label:
						text: 'Volume 1'
					TextInput:
						text: '.mrc'
						size_hint_x: .9
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					Label:
						text: 'Star file'
					TextInput:
						text: '.star'
						size_hint_x: .9
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					Label:
						text: 'Missing wedge file'
					TextInput:
						text: '.mrc'
						size_hint_x: .9
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					BoxLayout:
						orientation: 'horizontal'
						Label:
							text: 'CCC Threshold'
						AnchorLayout:
							anchor_x: 'left'
							TextInput: 
								text: '0'
								size_hint: .3, .7
								pos_hint: {'center_x': .5}
								multiline: False
					BoxLayout:
						orientation: 'horizontal'
						Label:
							text: 'Zoom range (px)'
						AnchorLayout:
							anchor_x: 'left'
							TextInput: 
								text: '40'
								size_hint: .3, .7
								pos_hint: {'center_x': .5}
								multiline: False
					Button:
						background_color: 0.2, 0.6, 0.2, .55
						text: 'Filter by CCC'
						on_release: root.filter_ccc()
						size_hint_x: .5
						pos_hint: {'center_x': .5, 'center_y': .5}
					Label:
						text: ' '
						size_hint_y: .1
				BoxLayout:
				BoxLayout:

	TabbedPanelItem:
		text: 'Inspect'
		BoxLayout:
			spacing: 10
			orientation: 'vertical'
			canvas:
				Color:
					rgba: 1, 1, 1, .2
				Rectangle:
					pos: self.pos
					size: self.size
			GridLayout:
				rows: 2
				cols: 2
				spacing: 15
				canvas:
					Color:
						rgba: 1, 1, 1, .6
					Rectangle:
						pos: self.pos
						size: self.size
				BoxLayout:
					canvas:
						Color:
							rgba: .5, .5, .5, 0.4
						Rectangle:
							pos: self.pos
							size: self.size
					orientation: 'vertical'
					Label:
						text: 'Box Zoom'
						color: (0,0,0,1)
						font_size: 35
						size_hint_y: .7
						pos_hint: {'center_x': .12}
						bold: True
					BoxLayout:
						orientation: 'horizontal'
						size_hint: .5, .8
						pos_hint: {'center_x': .5}
						Label: 
							text: 'zoom box size (px)'
							pos_hint: {'center_x': .2}
						TextInput:
							size_hint_x: .4
							pos_hint: {'center_x': .8}
							text: '90'
							multiline: False
					Label:
						text: 'Star file path'
						size_hint_y: .6
					TextInput:
						text: 'test.star'
						size_hint: .9, .7
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					Label:
						text: 'Subtomogram directory'
						size_hint_y: .6
					TextInput: 
						text: 'Extract/extract_test/201810XX_MPI/'
						size_hint: .9, .7
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					Label:
						text: 'Output directory'
						size_hint_y: .6
					TextInput:
						text: 'Extract/extract_test/201810XX_MPI_zoom/'
						size_hint: .9, .7
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					Label:
						text: ' '
						size_hint_y: .1
					Button:
						background_color: 0.2, 0.6, 0.2, .55
						text: 'Zoom and Cut'
						on_release: root.zoomcut()
						size_hint_x: .5
						pos_hint: {'center_x': .5, 'center_y': .5}
					Label:
						text: ' '
						size_hint_y: .1

				BoxLayout:
					orientation: 'vertical'
					canvas:
						Color:
							rgba: .5, .5, .5, 0.4
						Rectangle:
							pos: self.pos
							size: self.size
					Label:
						text: 'Rotate Subtomograms'
						color: (0,0,0,1)
						font_size: 35
						pos_hint: {'center_x': .24}
						bold: True
						size_hint_y: .8
					Label:
						text: 'Star file path'
						size_hint_y: .8
					TextInput:
						text: 'test.star'
						size_hint: .9, .7
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					Label:
						text: 'Subtomogram directory'
						size_hint_y: .8
					TextInput:
						text: 'Extract/extract_test/201810XX_MPI/'
						size_hint: .9, .7
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					Label:
						text: 'Output directory'
						size_hint_y: .8
					TextInput:
						text: 'Extract/extract_test/201810XX_MPI_rot/'
						size_hint: .9, .7
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					BoxLayout:
						orientation: 'horizontal'
						size_hint: .5, .8
						pos_hint: {'center_x': .4}
						CheckBox:
							state: 'down'
							pos_hint: {'center_x': .3}
						Label:
							text: 'Apply translations'
							pos_hint: {'center_x': .8}
					Button:
						background_color: 0.2, 0.6, 0.2, .55
						text: 'Rotate'
						on_release: root.rotate()
						size_hint: .4, .8
						pos_hint: {'center_x': .5, 'center_y': .5}
					Label: 
						text: ' '
						size_hint_y: .1
					
				BoxLayout:
					size_hint_y: .8
					orientation: 'vertical'
					canvas:
						Color:
							rgba: .5, .5, .5, 0.4
						Rectangle:
							pos: self.pos
							size: self.size
					Label: 
						color: (0,0,0,1)
						font_size: 35
						text: 'Stackbrowser'
						pos_hint: {'center_x': .15}
						bold: True
					Label: 
						text: 'Star file path'
						size_hint_y: .7
					TextInput:
						text: 'test.star'
						size_hint_x: .9
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					Label:
						text: 'Align file name (output)'
						size_hint_y: .7
					TextInput: 
						text: 'Align.mat'
						size_hint_x: .9
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
					Label:
						text: ' '
						size_hint_y: .1
					Button:
						background_color: 0.2, 0.6, 0.2, .55
						text: 'Make Align File'
						on_release: root.align()
						size_hint: .5, 1.2
						pos_hint: {'center_x': .5, 'center_y': .5}
					Label:
						text: 'Align file for stackbrowser'
						size_hint_y: .7
					TextInput:
						text: 'Align.mat'
						size_hint_x: .9
						pos_hint: {'center_x': .5, 'center_y': .5}
						multiline: False
						id: aligninput
					Label:
						text: ' '
						size_hint_y: .1
					Button:
						background_color: 0.2, 0.6, 0.2, .55
						text: 'Open Stackbrowser'
						on_release: root.stack()
						size_hint: .5, 1.2
						pos_hint: {'center_x': .5, 'center_y': .5}
					Label:
						text: ' '
						size_hint_y: .1

				BoxLayout:
					size_hint_y: .8
					orientation: 'vertical'
					spacing: 15
					Label:
						text: ' '

	TabbedPanelItem:
		text: 'Change Log'
		TextInput:
			multiline: True
			readonly: True
			font_size: 25
			text: 'Version 1.7\n-translated from MATLAB to Python script\n-added Master Key and implemented cwd checkboxes throughout program\n-added parser tool tab\n-moved box zoom and rotate subtomograms to obsolete tab\n\nVersion 1.63\n-added get dir button to filter function on Visualization tab\n-added help buttons (?) to give more information about directories for filter function on Visualization tab\n\nVersion 1.61\n-calculate angles tab added\n\nVersion 1.6\n-create coords button in coordinate picker is compatible with more input star files\n-calls coordinate_picker3 which has typo fix\n\nVersion 1.54\n-minor bug fixes in coordinate picker\n-get dir button in coordinate picker automatically adds / to end of path\n\nVersion 1.53\n-small bug fixes in coordinate picker.\n\nVersion 1.51\n-current file auto-updates after closing ChimeraX in coordinate picker.\n-add tool to save notes about subtomogtrams in coordinate picker.\n\nVersion 1.5\n-additional instruction added to Coordinate Picker.\n-status update of ChimeraX is provided after opening a file to prevent multiple clicks.\n-added option for output directory for the cmm coordinate files created by ChimeraX\n-added input option for the cmm coordinate files for the Creates .coords feature which makes .coordsshift files compatible with RELION3.\n-created change log tab.\n\nVersion 1.45\n-get dir button added. This allows you to update the mrc directory and Star file path fields to the current directory.\n-changed directory conventions for mrc directory and Star file path. You now need to enter the complete directories into this field (the get dir button follows this convention).\n-added get file name button which prints the current file name based on the index. The mrc directory combined with the file name is the path to the file that is opened in Chimera. You can check to make sure your path makes sense using this feature.\n-the default click in ChimeraX chooses the surface instead of the plane.'
